(this.webpackJsonpglobal_faciet=this.webpackJsonpglobal_faciet||[]).push([[0],{10:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(9),c=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"getRefreshToken",value:function(){return localStorage.getItem("refreshToken")}},{key:"getAccessToken",value:function(){return localStorage.getItem("accessToken")}},{key:"setRefreshToken",value:function(e){return localStorage.setItem("refreshToken",e)}},{key:"setAccessToken",value:function(e){return localStorage.setItem("accessToken",e)}},{key:"clear",value:function(){localStorage.clear()}}]),e}();t.default=c},100:function(e,t,n){},101:function(e,t,n){},108:function(e,t,n){},109:function(e,t,n){},110:function(e,t,n){},111:function(e,t,n){},112:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t),n.d(t,"friendListUrl",(function(){return a})),n.d(t,"addFriendUrl",(function(){return c})),n.d(t,"removeFriendUrl",(function(){return u}));var r=n(6),a=r.default+"/api/friends",c=r.default+"/api/friends/add",u=r.default+"/api/friends/remove"},117:function(e,t,n){},118:function(e,t,n){},119:function(e,t,n){},120:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(58),u=n.n(c),o=n(2),s=(n(66),n(17)),i=n(26),l=n.n(i),f=n(27),d=Object(r.createContext)({socket:l.a.connect(f.a)}),p=n(4),m=n(1),b=n.n(m),v=n(3);n(100);function k(e){var t=e.placeHodler,n=void 0===t?null:t,r=Object(s.a)(e,["placeHodler"]);return a.a.createElement("input",Object.assign({type:"text",className:"authInput",placeholder:n},r))}n(101);var h=n(16);var j=function(e){var t=e.setSocket,n=Object(r.useState)(!1),c=Object(o.a)(n,2),u=c[0],s=c[1],i=Object(r.useState)(""),l=Object(o.a)(i,2),f=l[0],d=l[1],p=Object(r.useState)(""),m=Object(o.a)(p,2),j=m[0],y=m[1],g=Object(r.useState)(""),O=Object(o.a)(g,2),E=O[0],x=O[1],w=Object(r.useState)(""),N=Object(o.a)(w,2),S=N[0],C=N[1],T=Object(r.useState)(""),_=Object(o.a)(T,2),A=_[0],F=_[1],I=Object(r.useState)(""),P=Object(o.a)(I,2),B=P[0],H=P[1],U=Object(r.useState)(!1),q=Object(o.a)(U,2),z=q[0],G=q[1];function L(){return(L=Object(v.a)(b.a.mark((function e(){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(f.length>2&&E.length>2&&j.length>2&&S.length>2&&A.length>2)||z){e.next=14;break}return G(!0),e.next=4,h.default.singup(E,j,f,A,S);case 4:if(!(n=e.sent).err){e.next=10;break}H(n.err),G(!1),e.next=12;break;case 10:return e.next=12,h.default.authorize().then((function(e){console.log(e,"signing up"),t(e)}));case 12:e.next=15;break;case 14:H("\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044f 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430");case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=Object(v.a)(b.a.mark((function e(){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(E.length>2&&j.length>2&&!1===z)){e.next=16;break}return G(!0),e.next=4,h.default.signin(E,j);case 4:if((n=e.sent).err){e.next=12;break}return e.next=8,h.default.authorize();case 8:r=e.sent,t(r),e.next=14;break;case 12:H(n.err),G(!1);case 14:e.next=17;break;case 16:H("\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u043d\u0430 \u0447\u0435\u043b\u0435\u043d\u0430 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430");case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return u?a.a.createElement("div",{className:"auth"},a.a.createElement(k,{placeHodler:"\u041d\u0438\u043a\u043d\u0435\u0439\u043c",name:"email",onChange:function(e){return x(e.target.value)}}),a.a.createElement(k,{placeHodler:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",onChange:function(e){return y(e.target.value)}}),a.a.createElement("p",{className:"err"},B),a.a.createElement("button",{className:"signin ".concat(z),onClick:function(){return function(){return J.apply(this,arguments)}()}},"\u0412\u043e\u0439\u0442\u0438"),a.a.createElement("button",{className:"signup ".concat(z),onClick:function(){return s(!1)}},"\u041d\u0435\u0442 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430")):a.a.createElement("div",{className:"auth"},a.a.createElement(k,{placeHodler:"Email",name:"new email",onChange:function(e){return d(e.target.value)}}),a.a.createElement(k,{placeHodler:"\u041d\u0438\u043a\u043d\u0435\u0439\u043c",name:"new nickname",onChange:function(e){return x(e.target.value)}}),a.a.createElement(k,{placeHodler:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"new password",onChange:function(e){return y(e.target.value)}}),a.a.createElement(k,{placeHodler:"SO2 \u043d\u0438\u043a\u043d\u0435\u0439\u043c",onChange:function(e){return F(e.target.value)}}),a.a.createElement(k,{placeHodler:"SO2 id",onChange:function(e){return C(e.target.value)}}),a.a.createElement("p",{className:"err"},B),a.a.createElement("button",{className:"signup ".concat(z),onClick:function(){return function(){return L.apply(this,arguments)}()}},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),a.a.createElement("button",{className:"signin ".concat(z),onClick:function(){return s(!0)}},"\u0423\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"))};function y(e){var t=e.path,n=e.setSocket,c=e.children,u=Object(s.a)(e,["path","setSocket","children"]);return Object(r.useContext)(d).socket?a.a.createElement(p.a,Object.assign({path:t},u),c):a.a.createElement(j,{setSocket:n})}var g=n(10);n(108);function O(){return a.a.createElement("div",{className:"preloader"},a.a.createElement("div",{className:"dot first"}),a.a.createElement("div",{className:"dot second"}),a.a.createElement("div",{className:"dot last"}))}n(109);var E=n(8),x=n(9),w=n(6).default,N=w+"/api/user",S=n(36),C=n(5),T=function(){function e(){Object(E.a)(this,e)}return Object(x.a)(e,null,[{key:"GetOwnProfie",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(N);case 2:return t=e.sent,e.next=5,t.body;case 5:if(n=e.sent,console.log(n,"get profile"),!n.err){e.next=12;break}return console.error(n.err),e.abrupt("return",!1);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"GetProfileByUsername",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(N,{username:t});case 2:if(n=e.sent,r=n.body,console.log(r,"get profile by username"),!r.err){e.next=16;break}return e.next=8,S.default.refreshByErr(r.err);case 8:if(!e.sent){e.next=13;break}this.GetProfileByUsername(t),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:e.next=17;break;case 16:return e.abrupt("return",r.user);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();n(110);function _(){var e=Object(r.useState)({username:"",rating:0,bio:""}),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){T.GetOwnProfie().then((function(e){e&&c(e)}))}),[]),a.a.createElement("div",{className:"userData"},a.a.createElement("div",{className:"avatar"}),a.a.createElement("div",{className:"textData"},a.a.createElement("div",{className:"username"},n.username),a.a.createElement("div",{className:"rating"},n.rating)),a.a.createElement("div",{className:"bio"},n.bio))}n(111);var A=n(6),F=A.default+"/api/party/invite",I=A.default+"/api/party/join",P=A.default+"/api/party/reject",B=A.default+"/api/party/leave",H=A.default+"/api/party/",U=A.default+"/api/party/kick",q=function(){function e(){Object(E.a)(this,e)}return Object(x.a)(e,null,[{key:"sendInvite",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(F,{username:t});case 2:return n=e.sent,e.next=5,n.body;case 5:if(r=e.sent,console.log(r,"send invite"),!r.err){e.next=11;break}console.error(r.err),e.next=12;break;case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptInvite",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.a.post(I,{id:t});case 3:return n=e.sent,e.next=6,n.body;case 6:if(r=e.sent,console.log(r,"accept invite"),!r.err){e.next=13;break}return console.error(r.err),e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"rejectInvite",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.a.post(P,{id:t});case 3:return n=e.sent,e.next=6,n.body;case 6:if(r=e.sent,console.log(r,"reject invite"),!r.err){e.next=13;break}return console.error(r.err),e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"leaveParty",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(B);case 2:return t=e.sent,e.next=5,t.body;case 5:if(n=e.sent,console.log(n,"leave party"),!n.err){e.next=12;break}return console.error(n.err),e.abrupt("return",!1);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"kick",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(U,{username:t});case 2:if(n=e.sent,console.log(n.body),!n.body.err){e.next=9;break}return console.error(n.body.err),e.abrupt("return",!1);case 9:return e.abrupt("return",n.body);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getParty",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(H,{method:"GET",headers:{Authorization:"Bearer "+g.default.getAccessToken()}});case 2:return t=e.sent,e.next=5,t.json();case 5:if(n=e.sent,console.log(n,"gett party"),!n.err){e.next=11;break}console.error(n.err),e.next=12;break;case 11:return e.abrupt("return",n.data);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();n(112);function z(e){var t=e.children,n=Object(s.a)(e,["children"]);return a.a.createElement("button",Object.assign({className:"btns cancel"},n),t)}function G(e){var t=e.children,n=Object(s.a)(e,["children"]);return a.a.createElement("button",Object.assign({className:"btns submit"},n),t)}function L(e){var t=Object.assign({},e);return a.a.createElement("button",Object.assign({className:"deleteBtn"},t),"X")}n(113);function J(e){var t=e.show,n=e.children;return a.a.createElement("div",{className:"overlay "+t},n)}function M(){var e=Object(r.useContext)(d).socket,t=Object(r.useState)({players:[],owner:""}),n=Object(o.a)(t,2),c=n[0],u=n[1],s=Object(r.useState)({id:"",username:""}),i=Object(o.a)(s,2),l=i[0],f=i[1],p=Object(r.useState)(""),m=Object(o.a)(p,2),b=m[0],v=m[1],k=Object(r.useState)(!1),h=Object(o.a)(k,2),j=h[0],y=h[1];return Object(r.useEffect)((function(){return e.on("party",(function(e){console.log(e,"socket party"),u(e.data)})),q.getParty().then((function(e){console.log(e,"fetch party"),u(e)})),function(){e.off("party")}}),[e]),Object(r.useEffect)((function(){T.GetOwnProfie().then((function(e){e&&f(e)}))}),[]),a.a.createElement("div",{className:"party"},a.a.createElement(J,{show:j},a.a.createElement("div",{className:"invite"},a.a.createElement("input",{type:"target",onChange:function(e){return v(e.target.value)},value:b}),a.a.createElement("div",{className:"controls"},a.a.createElement(z,{onClick:function(){return y(!1)}},"\u041e\u0442\u043c\u0435\u043d\u0430"),a.a.createElement(G,{onClick:function(){return y(!1),console.log(b),q.sendInvite(b),void v("")}},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")))),c.players.map((function(e){return a.a.createElement("div",{key:e.username,className:"member"},e.username,l.id===c.owner&&l.username!==e.username?a.a.createElement(L,{onClick:function(){return t=e.username,void q.kick(t);var t}}):"",c.owner===e.id?a.a.createElement("div",{className:"crown"}):"")})),5!==c.players.length?a.a.createElement("div",{className:"addMember member",onClick:function(){return y(!0)}},"\u041f\u0440\u0438\u0433\u043b\u0430\u0441\u0438\u0442\u044c \u0438\u0433\u0440\u043e\u043a\u0430"):"",1!==c.players.length?a.a.createElement("div",{className:"cancel member",onClick:function(){q.leaveParty()}},"\u0412\u044b\u0439\u0442\u0438"):"")}n(114);var Q=n(6).default,R=Q+"/api/queue/join",D=Q+"/api/queue/leave",W=function(){function e(){Object(E.a)(this,e)}return Object(x.a)(e,null,[{key:"JoinQueue",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(R);case 2:return t=e.sent,e.next=5,t.body;case 5:if(n=e.sent,console.log(n,"join queue"),!n.err){e.next=11;break}return e.abrupt("return",!1);case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"LeaveQueue",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(D);case 2:return t=e.sent,e.next=5,t.body;case 5:if(n=e.sent,console.log(n,"leave queue"),!n.err){e.next=11;break}return e.abrupt("return",!1);case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),V=1;function X(){var e=Object(r.useContext)(d).socket,t=Object(r.useState)(!1),n=Object(o.a)(t,2),c=n[0],u=n[1],s=Object(r.useState)(""),i=Object(o.a)(s,2),l=i[0],f=i[1];function p(){f("shake"),setTimeout((function(){f("")}),500)}return Object(r.useEffect)((function(){return q.getParty().then((function(e){e.status===V?u(!0):u(!1)})),e.on("queue",(function(e){console.log(e,"search"),e.data?u(!0):u(!1)})),function(){e.off("queue")}}),[e]),a.a.createElement("div",{className:"search"},a.a.createElement("button",{className:(c?"red ":" ")+l,onClick:function(){c?W.LeaveQueue().then((function(e){return e?u(!1):p()})):W.JoinQueue().then((function(e){return e?u(!0):p()}))}},c?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u0418\u0441\u043a\u0430\u0442\u044c"))}function $(){return a.a.createElement("div",{className:"matchMaking"},a.a.createElement(_,null),a.a.createElement(X,null),a.a.createElement(M,null))}var K=n(28),Y=(n(115),n(123)),Z=[{url:"/",name:"MM"},{url:"/friends",name:"Friends"},{url:"/notifications",name:"nots"}];function ee(){var e=Object(p.f)();return a.a.createElement("div",{className:"navbar"},Z.map((function(t){return a.a.createElement(K.b,{className:e.pathname===t.url?"navLink active":"navLink",to:t.url,key:Object(Y.a)()},t.name)})))}var te=n(20),ne=n(116),re=ne.addFriendUrl,ae=ne.removeFriendUrl,ce=ne.friendListUrl,ue=n(36).default,oe=function(){function e(){Object(E.a)(this,e)}return Object(x.a)(e,null,[{key:"addFriend",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(re,{username:t});case 2:if(n=e.sent,r=n.body,console.log(r,"add friend"),!r.err){e.next=16;break}return e.next=8,ue.refreshByErr(r.err);case 8:if(!e.sent){e.next=13;break}this.addFriend(t),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:e.next=17;break;case 16:return e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeFriend",value:function(){var e=Object(v.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(ae,{id:t});case 2:if(n=e.sent,r=n.body,console.log(r,"remove friend"),!r.err){e.next=10;break}return console.error(r.err),e.abrupt("return",!1);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFriends",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(ce);case 2:if(t=e.sent,n=t.body,console.log(n,"get friends"),!n.err){e.next=10;break}return console.error(n.err),e.abrupt("return",!1);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();n(117),n(118);function se(e){var t=e.data,n=e.destroy,r=void 0===n?function(){}:n;return a.a.createElement("div",{className:"friend"},a.a.createElement("div",{className:"data"},a.a.createElement("div",{className:"username"},t.username)),a.a.createElement("div",{className:"controls"},a.a.createElement(G,{onClick:function(){q.sendInvite(t.username)}},"\u041f\u0440\u0438\u0433\u043b\u0430\u0441\u0438\u0442\u044c"),a.a.createElement(L,{onClick:function(){return oe.removeFriend(t.id),void r()}})))}function ie(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],u=Object(r.useState)(""),s=Object(o.a)(u,2),i=s[0],l=s[1],f=Object(r.useState)(!1),d=Object(o.a)(f,2),p=d[0],m=d[1];return Object(r.useEffect)((function(){oe.getFriends().then((function(e){e&&(console.log(e[0]),c(e))}))}),[]),a.a.createElement("div",{className:"friends"},a.a.createElement("div",{className:"controls"},a.a.createElement(G,{onClick:function(){return m(!0)}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),a.a.createElement(J,{show:p},a.a.createElement("div",{className:"addFriend"},a.a.createElement("input",{type:"target",onChange:function(e){return l(e.target.value)},value:i}),a.a.createElement("div",{className:"controls"},a.a.createElement(z,{onClick:function(){return m(!1)}},"\u041e\u0442\u043c\u0435\u043d\u0430"),a.a.createElement(G,{onClick:function(){return m(!1),oe.addFriend(i),void l("")}},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")))),n.map((function(e,t){return a.a.createElement(se,{key:e.username,data:e,destroy:function(){return function(e){c((function(t){var n=Object(te.a)(t);return n.splice(e),n}))}(t)}})})))}n(119);function le(e){var t=e.id,n=e.from,c=e.destroy,u=Object(r.useState)(""),s=Object(o.a)(u,2),i=s[0],l=s[1];return a.a.createElement("div",{className:"notification invite "+i},a.a.createElement("p",null,"\u0418\u043d\u0432\u0430\u0439\u0442 \u043e\u0442 ",n),a.a.createElement("div",{className:"controls"},a.a.createElement(z,{onClick:function(){return function(e){l("remove"),setTimeout((function(){c()}),340),q.rejectInvite(e)}(t)}},"\u041e\u0442\u043c\u0435\u043d\u0430"),a.a.createElement(G,{onClick:function(){return function(e){l("remove"),setTimeout((function(){c()}),340),q.acceptInvite(e)}(t)}},"\u041f\u0440\u0438\u043d\u044f\u0442\u044c")))}function fe(e){var t=e.from,n=e.destroy,c=Object(r.useState)(""),u=Object(o.a)(c,2),s=u[0],i=u[1];return a.a.createElement("div",{className:"notification invite "+s},a.a.createElement("p",null,"\u041f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u0432 \u0434\u0440\u0443\u0437\u044c\u044f \u043e\u0442 ",t.username),a.a.createElement("div",{className:"controls"},a.a.createElement(z,{onClick:function(){return t.username,i("remove"),void setTimeout((function(){n()}),340)}},"\u041e\u0442\u043c\u0435\u043d\u0430"),a.a.createElement(G,{onClick:function(){return e=t.username,i("remove"),setTimeout((function(){n()}),340),void oe.addFriend(e);var e}},"\u041f\u0440\u0438\u043d\u044f\u0442\u044c")))}n(120);function de(){var e=Object(r.useContext)(d).socket,t=Object(r.useState)([]),n=Object(o.a)(t,2),c=n[0],u=n[1];return Object(r.useEffect)((function(){var t=function(e){u((function(t){var n=Object(te.a)(t);return n.splice(e,1),n}))};return e&&e.on("notification",(function(e){switch(console.log(e),e.type){case"party/invite":u((function(n){return[].concat(Object(te.a)(n),[a.a.createElement(le,{id:e.data.id,from:e.data.players[0].username,key:Object(Y.a)(),destroy:function(){return t(n.length)}})])}));break;case"friends/add":u((function(n){return[].concat(Object(te.a)(n),[a.a.createElement(fe,{from:e.data,key:Object(Y.a)(),destroy:function(){return t(n.length)}})])}))}})),function(){e&&e.off("notification")}}),[e]),a.a.createElement("div",{className:"notifications"},c)}var pe=n(14),me=A.default+"/api/notifications",be=function(){function e(){Object(E.a)(this,e)}return Object(x.a)(e,null,[{key:"get",value:function(){var e=Object(v.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(me);case 2:return t=e.sent,e.next=5,t.body;case 5:if(n=e.sent,console.log(n,"get notifications"),!n.err){e.next=12;break}return console.error(n.err),e.abrupt("return",!1);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();n(121);function ve(){var e=Object(r.useState)({party:[],friends:[]}),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){be.get().then((function(e){e&&c(e)}))}),[]),a.a.createElement("div",{className:"notificationsView"},n.friends.map((function(e,t){return a.a.createElement(fe,{from:e.username,destroy:function(){return function(e){c((function(t){var n=Object(pe.a)({},t);return n.friends.splice(e,1),n}))}(t)}})})),n.party.map((function(e,t){return a.a.createElement(le,{from:e.players[0].username,id:e.id,destroy:function(){return function(e){c((function(t){var n=Object(pe.a)({},t);return n.party.splice(e,1),n}))}(t)}})})))}var ke=function(){var e=Object(r.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],u=Object(r.useState)(!0),s=Object(o.a)(u,2),i=s[0],l=s[1];return Object(r.useEffect)((function(){g.default.getAccessToken()?h.default.authorize().then((function(e){e.on("connect",(function(){return console.log("connected")})),e.on("disconnect",(function(){console.log("disconnected"),l(!1)})),e.on("auth",(function(){console.log("authed"),c(e),l(!1)})),e.on("unauth",(function(){console.log("unauth"),l(!1)}))})):l(!1)}),[]),i?a.a.createElement(O,null):n?a.a.createElement("div",{className:"App"},a.a.createElement(d.Provider,{value:{socket:n}},a.a.createElement(K.a,null,a.a.createElement(de,null),a.a.createElement(p.c,null,a.a.createElement(y,{path:"/",setSocket:c,exact:!0},a.a.createElement($,null)),a.a.createElement(y,{path:"/friends",setSocket:c,exact:!0},a.a.createElement(ie,null)),a.a.createElement(y,{path:"/notifications",setSocket:c,exact:!0},a.a.createElement(ve,null)),a.a.createElement(p.a,{path:"/auth"},a.a.createElement(j,{setSocket:c}))),a.a.createElement(ee,null)))):(console.log("not auhed"),a.a.createElement("div",{className:"App"},a.a.createElement(j,{setSocket:c})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ke,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},16:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(3),u=n(8),o=n(9),s=n(6),i=s.default+"/api/auth/signup",l=s.default+"/api/auth/signin",f=(s.default,s.default+"/api/auth/refresh"),d=n(26),p=n.n(d),m=n(27),b=n(10),v=n(5),k=function(){function e(){Object(u.a)(this,e)}return Object(o.a)(e,null,[{key:"singup",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n,r,c,u){var o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post(i,{username:t,password:n,email:r,so2_nickname:c,so2_id:u});case 2:if(o=e.sent,s=o.body,console.log(s),!s.err){e.next=9;break}return e.abrupt("return",{err:s.err});case 9:return console.log(s.access_token),b.default.setAccessToken(s.access_token),e.abrupt("return",{refreshToken:s.refresh_token,access_token:s.access_token});case 12:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c){return e.apply(this,arguments)}}()},{key:"signin",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post(l,{username:t,password:n});case 2:if(r=e.sent,c=r.body,console.log(c),!c.err){e.next=9;break}return e.abrupt("return",{err:c.err});case 9:return b.default.setAccessToken(c.access_token),e.abrupt("return",{refreshToken:c.refreshToken,accessToken:c.access_token});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"authorize",value:function(){var e=Object(c.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.a.connect(m.a,{query:{token:b.default.getAccessToken()},secure:!0}),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"refreshAccessToken",value:function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post(f,{refresh_token:t});case 2:return n=e.sent,e.next=5,n.body;case 5:if(!(r=e.sent).err){e.next=10;break}return e.abrupt("return",{err:r.err});case 10:return e.abrupt("return",{access_token:r.access_token,refresh_token:r.refresh_token});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=k},27:function(e,t,n){"use strict";t.a="https://totalifydev.tk"},36:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(3),u=n(8),o=n(9),s=n(16).default,i=n(10).default,l=function(){function e(){Object(u.a)(this,e)}return Object(o.a)(e,null,[{key:"refreshByErr",value:function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("jwt expired"!==t.name){e.next=13;break}return e.next=3,s.refreshAccessToken(i.getRefreshToken());case 3:if(!(n=e.sent).err){e.next=9;break}return i.clear(),e.abrupt("return",!1);case 9:return i.setAccessToken(n.access_token),e.abrupt("return",n.access_token);case 11:e.next=14;break;case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=l},5:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(1),a=n.n(r),c=n(14),u=n(3),o=n(8),s=n(9),i=n(10),l=n(37),f=n.n(l),d=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,null,[{key:"get",value:function(){var e=Object(u.a)(a.a.mark((function e(t){var n,r,u,o,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2&&void 0!==s[2]?s[2]:{},u="?",u+=f.a.stringify(n),e.next=6,fetch(t+u,{method:"GET",headers:Object(c.a)({Authorization:"Bearer "+i.default.getAccessToken(),creditionals:"include"},r)});case 6:return o=e.sent,e.t0=c.a,e.t1=Object(c.a)({},o),e.t2={},e.next=12,o.json();case 12:return e.t3=e.sent,e.t4={body:e.t3},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t4));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(u.a)(a.a.mark((function e(t){var n,r,u,o,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2&&void 0!==s[2]?s[2]:{},u=s.length>3&&void 0!==s[3]?s[3]:{},e.next=5,fetch(t+"?".concat(f.a.stringify(r)),{method:"POST",headers:Object(c.a)({Authorization:"Bearer "+i.default.getAccessToken(),creditionals:"include","Content-type":"application/json"},u),body:JSON.stringify(n)});case 5:return o=e.sent,e.t0=c.a,e.t1=Object(c.a)({},o),e.t2={},e.next=11,o.json();case 11:return e.t3=e.sent,e.t4={body:e.t3},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t4));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},6:function(e,t,n){"use strict";n.r(t);t.default="https://totalifydev.tk"},61:function(e,t,n){e.exports=n(122)},66:function(e,t,n){},96:function(e,t){}},[[61,1,2]]]);
//# sourceMappingURL=main.f0ba34b4.chunk.js.map